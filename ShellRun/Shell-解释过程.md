# 15.Shell 解释过程

bash(ksh)命令的解释过程：
分析命令
变量求值
命令替代
重定向
通配符展开
确定路径

01．  Shell首先从命令行中找出特殊字符（元字符），在将元字符翻译成间隔符号，元字符将命令行划分成小块tokens。
         Shell中的元字符如下所示： 
         SPACE , TAB , NEWLINE , & , ; , ( , ) ,< , > , | 
02．  程序块tokens被处理，检查看他们是否是shell中所引用到的关键字。 
03．  当程序块tokens被确定以后，shell根据aliases文件中的列表来检查命令的第一个单词。
         如果这个单词出现在aliases表中，执行替换操作并且处理过程回到第一步重新分割程序块tokens。
04．  Shell对~符号进行替换。 
05．  Shell对所有前面带有$符号的变量进行替换。 
06．  Shell将命令行中的内嵌命令表达式替换成命令，他们一般都采用$(command)标记法。 
07．  Shell计算采用$((expression))标记的算术表达式。 
08．  Shell将命令字符串重新划分为新的块tokens。
         这次划分的依据是栏位分割符号，称为IFS。缺省的IFS变量包含有：SPACE , TAB 和换行符号。 
09．  Shell执行通配符* ? [ ]的替换。 
10．  Shell把所有从处理的结果中用到的注释删除，並且按照下面的顺序实行命令的检查： 
         内建的命令 、shell函数（由用户自己定义的） 可执行的脚本文件（需要寻找文件和PATH路径） 
11．  在执行前的最后一步是初始化所有的输入输出重定向。 
12．  最后，执行命令。 

## Shell 执行过程

如果用双引号包括起来，Shell检测跳过了1-4步和9-10步，单引号包括起来，Shell检测就会跳过了1-10步。
也就是说，双引号只经过参数展开、命令替换和算术展开就可以送入执行步骤，而单引号转义符直接会被送入执行步骤。
而且，无论是双引号转义符还是单引号转义符在执行的时候能够告诉各个命令自身内部是一体的，但是其本身在执行时是并不是命令中文本的一部分。

## 脚本 语言解释器设置

#!/usr/bin/env python与#!/usr/bin/python的区别
脚本语言的第一行，目的就是指出，你想要你的这个文件中的代码用什么可执行程序去运行它，就这么简单。

#!/usr/bin/python
是告诉操作系统执行这个脚本的时候，调用/usr/bin下的python解释器。

#!/usr/bin/env python
这种用法是为了防止操作系统用户没有将python装在默认的/usr/bin路径里。
当系统看到这一行的时候，首先会到env设置里查找python的安装路径，再调用对应路径下的解释器程序完成操作。

#!/usr/bin/python相当于写死了python路径;
#!/usr/bin/env python会去环境设置寻找python目录，推荐这种写法
